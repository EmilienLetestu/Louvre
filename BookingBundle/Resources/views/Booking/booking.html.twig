{% extends "ELBookingBundle::layout.html.twig" %}

{% block title %}{{ parent() }} - Commande des tickets  {% endblock %}

{% block body %}
    <div class="col-sm-12">
        <h1 id ="booking_title">Commander des billets pour ma visite du {{ app.session.get('user_date') }}</h1>
    </div>
    <div class="col-sm-5">
        {{ form_start(ticket_form)}}

        {{ form_label(ticket_form.name) }}
        {{ form_widget(ticket_form.name) }}
        <span class ="form_errors">{{ form_errors(ticket_form.name) }}</span>

        {{ form_label(ticket_form.surname) }}
        {{ form_widget(ticket_form.surname) }}
        <span class ="form_errors">{{ form_errors(ticket_form.surname) }}</span>

        {{ form_label(ticket_form.dob) }}
        {{ form_widget(ticket_form.dob) }}
        <span class ="form_errors"> {{ form_errors(ticket_form.dob) }}</span>

        {% if(app.session.get('full_day_ticket') == true) %}
            {{ form_label(ticket_form.time_access) }}
            {{ form_widget(ticket_form.time_access) }}
        {% endif %}
        {% if(app.session.get('full_day_ticket') == false) %}
            <span>Type de ticket: {{ ticket.timeAccessType }}</span>
        {% endif %}

        {{ form_label(ticket_form.discount) }}
        {{ form_widget(ticket_form.discount) }}

        {{ form_end(ticket_form) }}

        {{ form(ticket_form) }}
    </div>
    {% if (app.session.get('order') != null)%}
        {% set order_in_progress = app.session.get('order')  %}
      <div class="col-sm-7">
              <table class="table table-responsive table-striped table-hover">
                <thead>
                    <tr>
                        <th>Porteur du billet</th>
                        <th>Valable le</th>
                        <th>Type de billet</th>
                        <th class="pricing_type">Prix du billet</th>
                        <th class="action_type">Modifier</th>
                        <th class="action_type">Supprimer</th>
                    </tr>
                </thead>
        {% for key,value in order_in_progress %}
            {% for ticket in value %}
                <tbody>
                    <tr>
                        <td>{{ ticket.name }} {{ ticket.surname }}</td>
                        <td>{{ ticket.date }}</td>
                        <td>{{ ticket.timeAccessType }} ,{{ ticket.priceType }}</td>
                        <td class="pricing_type">{{ ticket.price }} €</td>
                        <td class="action_type"><a class="btn btn-warning" href="{{ path('modifier_ticket',{'id' :key}) }}"> Modidfier </a></td>
                        <td class="action_type"><a class="btn btn-danger"  href="{{ path('supprimer_ticket',{'id' :key}) }}"> Supprimer </a></td>
                    </tr>
                </tbody>
            {% endfor %}
        {% endfor %}
              </table>
            </div>
            <div class = "col-sm-3" id="quote_for_order">
                <p>Nombre de billets :{{ app.session.get('tickets') }}</p>
                <p>Total de la commnade en cours :{{ app.session.get('total') }} €</p>
                <a class="btn btn-success" id="link_to_charge" href="{{ path('payer_commande') }}"> Payer </a>
            </div>
    {% endif %}
{% endblock %}