{% extends "ELBookingBundle::layout.html.twig" %}

{% block title %} {{ parent() }} - Payement des billets {% endblock %}

{% block body %}
    {% for flashMessage in app.session.flashbag.get('success') %}
      <div class="col-sm-6 offset-sm-3 success">{{ flashMessage }}</div>
    {% endfor %}
    {% for flashMessage in app.session.flashbag.get('stripe_error') %}
        <div class="col-sm-6 offset-sm-3 error">{{ flashMessage }}</div>
    {% endfor %}
    <div class="col-sm-12">
        <h1 id="charge_title">Payer {{ app.session.get('total') }} â‚¬ pour {{ app.session.get('tickets') }} billets</h1>
    </div>
    <div class = "col-sm-4 col stripe_form">
        {{ form_start(stripe_form, {'attr': {'id': 'payment_form'}}) }}
        <div class = "form-group">
            {{ form_label(stripe_form.name) }}
            {{ form_widget(stripe_form.name) }}
            <span class ="form_errors">{{ form_errors(stripe_form.name) }}</span>
        </div >
        <div class = "form-group">
            {{ form_label(stripe_form.surname) }}
            {{ form_widget(stripe_form.surname) }}
            <span class="form_errors">{{ form_errors(stripe_form.surname) }}</span>
        </div>
        <div class = "form-group">
            {{ form_label(stripe_form.email) }}
            {{ form_widget(stripe_form.email) }}
            <span class="form_errors">{{ form_errors(stripe_form.email) }}</span>
        </div>
        <div class = "form-group col-sm-6 card_input">
            {{ form_label(stripe_form.number) }}
            {{ form_widget(stripe_form.number,{'attr':{'data-stripe':'number'}} ) }}
            <span class="form_errors">{{ form_errors(stripe_form.number) }}</span>
        </div>
        <div class = "form-group col-sm-2"  title='les 3 chiffres au dos de votre carte'>
            {{ form_label(stripe_form.cvc) }}
            {{ form_widget(stripe_form.cvc, {'attr':{'data-stripe':'cvc'}}) }}
            <span class="col-sm-1 form_errors">{{ form_errors(stripe_form.cvc) }} </span>
        </div>
        <div id="card_data">
            <p>Expire en :</p>
        </div>
        <div class = "form-group col-sm-2">
            {{ form_widget(stripe_form.exp_month, {'attr':{'data-stripe':'exp_month'}}) }}
            <span class="col-sm-1 form_errors">{{ form_errors(stripe_form.exp_month) }}</span>
        </div>
        <div class = "form-group col-sm-2">
            {{ form_widget(stripe_form.exp_year, {'attr':{'data-stripe':'exp_year'}}) }}
            <span class="col-sm-1 form_errors">{{ form_errors(stripe_form.exp_year) }}</span>
    </div>
        <div class = "form-group col-sm-offset-4">
            <button type="submit" class="btn btn-success">Valider et payer</button>
        </div>
            {{ form_row(stripe_form.stripeToken) }}
        {{ form_end(stripe_form) }}
    </div>
    {% block javascripts %}
        {{ parent() }}
        <script src="{{ asset("CustomJs/stripeForm.js") }}"></script>
    {% endblock %}
{%  endblock %}
